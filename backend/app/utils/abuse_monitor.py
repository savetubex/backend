import time\nfrom collections import defaultdict\nfrom typing import Dict, List\n\nclass AbuseMonitor:\n    def __init__(self):\n        self.request_history: Dict[str, List[float]] = defaultdict(list)\n        self.blocked_ips: set = set()\n        self.suspicious_patterns = [\n            'bot', 'crawler', 'scraper', 'automated'\n        ]\n    \n    def is_suspicious_request(self, ip: str, user_agent: str = '') -> bool:\n        \"\"\"Check if request shows signs of abuse\"\"\"\n        current_time = time.time()\n        \n        # Check if IP is blocked\n        if ip in self.blocked_ips:\n            return True\n        \n        # Check user agent for suspicious patterns\n        if any(pattern in user_agent.lower() for pattern in self.suspicious_patterns):\n            return True\n        \n        # Check request frequency (more than 10 requests in 1 minute)\n        recent_requests = [\n            req_time for req_time in self.request_history[ip]\n            if current_time - req_time < 60\n        ]\n        \n        if len(recent_requests) > 10:\n            self.blocked_ips.add(ip)\n            return True\n        \n        # Log this request\n        self.request_history[ip].append(current_time)\n        \n        # Clean old requests (older than 1 hour)\n        self.request_history[ip] = [\n            req_time for req_time in self.request_history[ip]\n            if current_time - req_time < 3600\n        ]\n        \n        return False\n    \n    def get_stats(self) -> dict:\n        \"\"\"Get monitoring statistics\"\"\"\n        return {\n            'blocked_ips': len(self.blocked_ips),\n            'active_ips': len(self.request_history),\n            'total_requests': sum(len(requests) for requests in self.request_history.values())\n        }